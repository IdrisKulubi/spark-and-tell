# 🔍 Connection Debug Guide\n\n## 🎯 **Issue Identified:**\nThe connection is showing `disconnected` because the multiplayer flow hasn't been initiated yet.\n\n## 📋 **Debug Steps:**\n\n### **Step 1: Start Multiplayer Flow**\n1. ✅ Go to the landing page\n2. ✅ Click **\"Play Online 🌐\"** button (NOT \"Play Together 👫\")\n3. ✅ This should trigger `setGamePhase(\"multiplayer-setup\")`\n4. ✅ Check console for: `🔍 Checking for saved session`\n\n### **Step 2: Create Room (Host)**\n1. ✅ Enter your name (e.g., \"nicole\")\n2. ✅ Click **\"Create Room\"**\n3. ✅ Check console for: `🏠 Room created successfully`\n4. ✅ Should see room code (6 digits)\n5. ✅ Connection status should change to `connected`\n\n### **Step 3: Join Room (Guest)**\n1. ✅ Open second browser tab/window\n2. ✅ Click **\"Play Online 🌐\"**\n3. ✅ Enter name (e.g., \"test\")\n4. ✅ Enter the room code from Step 2\n5. ✅ Click **\"Join Room\"**\n6. ✅ Check console for: `🚪 Joined room successfully`\n\n### **Step 4: Verify Connection**\n1. ✅ Both players should see each other in the lobby\n2. ✅ Host should see \"Start Game\" button\n3. ✅ Console should show: `connectionStatus: 'connected'`\n4. ✅ Console should show: `multiplayerPhase: 'setup'`\n\n## 🔍 **Expected Console Output:**\n\n### **Before Multiplayer Setup:**\n```\n🎮 GameContainer state: {\n    gamePhase: 'landing',\n    multiplayerPhase: 'landing',\n    connectionStatus: 'disconnected',\n    isMultiplayer: false\n}\n🔍 Checking for saved session: {\n    savedPlayerId: \"NONE\",\n    savedRoomId: \"NONE\",\n    connectionStatus: \"disconnected\"\n}\n```\n\n### **After Clicking \"Play Online\":**\n```\n🎮 GameContainer state: {\n    gamePhase: 'multiplayer-setup',\n    multiplayerPhase: 'landing',\n    connectionStatus: 'disconnected',\n    isMultiplayer: false\n}\n```\n\n### **After Creating/Joining Room:**\n```\n🎮 GameContainer state: {\n    gamePhase: 'multiplayer-setup',\n    multiplayerPhase: 'setup',\n    connectionStatus: 'connected',\n    isMultiplayer: true\n}\n🔍 Checking for saved session: {\n    savedPlayerId: \"EXISTS\",\n    savedRoomId: \"EXISTS\",\n    connectionStatus: \"connected\"\n}\n```\n\n## 🚨 **Common Issues:**\n\n### **Issue 1: Still Disconnected After Room Creation**\n- **Cause**: Server not running or API errors\n- **Check**: Network tab for failed API calls\n- **Fix**: Restart server, check console for errors\n\n### **Issue 2: Room Code Not Working**\n- **Cause**: Room expired or invalid code\n- **Check**: Console for \"Room not found\" errors\n- **Fix**: Create new room, ensure code is correct\n\n### **Issue 3: Auto-Reconnection Not Working**\n- **Cause**: localStorage cleared or session expired\n- **Check**: `localStorage.getItem(\"spark-tell-player-id\")`\n- **Fix**: Create new room/join again\n\n## 🎮 **Testing Checklist:**\n\n### **Single Player Test:**\n- [ ] Landing page loads\n- [ ] \"Play Online\" button works\n- [ ] Multiplayer setup screen appears\n- [ ] Can enter name and create room\n- [ ] Room code appears\n- [ ] Connection status becomes \"connected\"\n\n### **Two Player Test:**\n- [ ] Second player can join with room code\n- [ ] Both players appear in lobby\n- [ ] Host can start game\n- [ ] Game phases work correctly\n- [ ] Dice rolling works without errors\n- [ ] Turn switching works\n\n## 🔧 **Quick Fix Commands:**\n\n### **Clear Session (if stuck):**\n```javascript\n// Run in browser console\nlocalStorage.removeItem(\"spark-tell-player-id\");\nlocalStorage.removeItem(\"spark-tell-room-id\");\nlocation.reload();\n```\n\n### **Check Session:**\n```javascript\n// Run in browser console\nconsole.log({\n    playerId: localStorage.getItem(\"spark-tell-player-id\"),\n    roomId: localStorage.getItem(\"spark-tell-room-id\")\n});\n```\n\nThis debug guide should help identify exactly where the connection is failing! 🔍✨"